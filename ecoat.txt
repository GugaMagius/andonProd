select 
ce.id,
ce.data,
convert(time, data) Hora,
CASE
	WHEN DATEPART(hh,ce.data)<6 then data-1
	ELSE data
END DataProd
from cicloEcoat ce
where CASE
	WHEN DATEPART(hh,ce.data)<6 then data-1
	ELSE data
END >= convert(datetime2, DATEADD(dd, 0, DATEDIFF(dd, 0, GETDATE()-1))) 

